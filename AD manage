--- AD instalacja -----
gpupdate /force
gpresult /scope user /v
gpresult /scope Computer /v


--- get all ad compuer ----
Get-ADComputer -Filter * -properties *|select Name, DNSHostName, OperatingSystem, LastLogonDate, Description

### szukaj zablokowanych uzytkownik√≥w  ###
Search-ADAccount -lockedout |select SamAccountName, LastLogonDate, LockedOut, Enabled
## lista wszystkich z opicem czy zablokowany czy nie ###
Get-ADUser -Filter * -Properties * | Select-Object LockedOut, name
###unlock user
Unlock-ADAccount -Identity username

Get-ADUser -Filter * -Properties * | select *

Get-ADGroup -Filter * |select Name

Add-ADGroupMember -Identity 'Skaner Drive' -Members username

Add-ADGroupMember -Identity 'KIR' -Members "computermane$"

Get-ADGroupMember -Identity 'Skaner Drive'

Get-ADUser -Filter 'SamAccountName -like "*.*"' |select SamAccountName

##smb share 
$cred = Get-Credential -Credential Contoso\ServiceAccount
New-PSDrive -Name "S" -Root "\\Server01\Scripts" -Persist -PSProvider "FileSystem" -Credential $cred
Net Use


------------pobiera nazwy folderow w sciezce i zapisuje je do zmiennej -------------

$dir = dir d:\directory | ?{$_.PSISContainer}

foreach ($d in $dir){
    $name = Join-Path -Path $d.FullName -ChildPath ($d.Name + ".7z")
    $path = Join-Path -Path $d.FullName -ChildPath "*"

    & "C:\Program Files\7-Zip\7z.exe" a -t7z $name $path
}
------------------
